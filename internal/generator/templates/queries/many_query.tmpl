// {{.FunctionName}} executes the {{.QueryName}} query and returns multiple results
func (r *{{.RepositoryName}}) {{.FunctionName}}(ctx context.Context{{.ParameterDeclarations}}) ([]{{.ResultType}}, error) {
	query := `{{.SQL}}`
	
	rows, err := r.db.Query(ctx, query{{.ParameterArgs}})
	if err != nil {
		return nil, HandleDatabaseError("{{.QueryName}}", "{{.ResultType}}", err)
	}
	defer rows.Close()
	
	var results []{{.ResultType}}
	for rows.Next() {
		var result {{.ResultType}}
		err := rows.Scan({{.ScanArgs}})
		if err != nil {
			return nil, HandleDatabaseError("scan", "{{.ResultType}}", err)
		}
		results = append(results, result)
	}
	
	return results, HandleRowsError("{{.ResultType}}", rows.Err())
} 